<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Response (opium.Opium__.Response)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">opium</a> &#x00BB; <a href="../index.html">Opium__</a> &#x00BB; Response</nav><h1>Module <code>Opium__.Response</code></h1><nav class="toc"><ul><li><a href="#constructors">Constructors</a><ul><li><a href="#make"><code>make</code></a></li><li><a href="#of_plain_text"><code>of_plain_text</code></a></li><li><a href="#of_json"><code>of_json</code></a></li><li><a href="#of_html"><code>of_html</code></a></li><li><a href="#of_xml"><code>of_xml</code></a></li><li><a href="#of_svg"><code>of_svg</code></a></li><li><a href="#redirect_to"><code>redirect_to</code></a></li></ul></li><li><a href="#decoders">Decoders</a><ul><li><a href="#to_json"><code>to_json</code></a></li><li><a href="#to_json_exn"><code>to_json_exn</code></a></li><li><a href="#to_plain_text"><code>to_plain_text</code></a></li></ul></li><li><a href="#getters-and-setters">Getters and Setters</a><ul><li><a href="#status"><code>status</code></a></li><li><a href="#set_status"><code>set_status</code></a></li><li><a href="#general-headers">General Headers</a><ul><li><a href="#headers"><code>headers</code></a></li><li><a href="#add_header"><code>add_header</code></a></li><li><a href="#add_header_or_replace"><code>add_header_or_replace</code></a></li><li><a href="#add_header_unless_exists"><code>add_header_unless_exists</code></a></li><li><a href="#add_headers"><code>add_headers</code></a></li><li><a href="#add_headers_or_replace"><code>add_headers_or_replace</code></a></li><li><a href="#add_headers_unless_exists"><code>add_headers_unless_exists</code></a></li><li><a href="#remove_header"><code>remove_header</code></a></li></ul></li><li><a href="#specific-headers">Specific Headers</a><ul><li><a href="#content_type"><code>content_type</code></a></li><li><a href="#set_content_type"><code>set_content_type</code></a></li><li><a href="#etag"><code>etag</code></a></li><li><a href="#set_etag"><code>set_etag</code></a></li><li><a href="#location"><code>location</code></a></li><li><a href="#set_location"><code>set_location</code></a></li><li><a href="#cache_control"><code>cache_control</code></a></li><li><a href="#set_cache_control"><code>set_cache_control</code></a></li><li><a href="#cookie"><code>cookie</code></a></li><li><a href="#cookies"><code>cookies</code></a></li><li><a href="#add_cookie"><code>add_cookie</code></a></li><li><a href="#add_cookie_or_replace"><code>add_cookie_or_replace</code></a></li><li><a href="#add_cookie_unless_exists"><code>add_cookie_unless_exists</code></a></li><li><a href="#remove_cookie"><code>remove_cookie</code></a></li></ul></li></ul></li><li><a href="#utilities">Utilities</a><ul><li><a href="#sexp_of_t"><code>sexp_of_t</code></a></li><li><a href="#pp"><code>pp</code></a></li><li><a href="#pp_hum"><code>pp_hum</code></a></li></ul></li></ul></nav></header><aside><p>Module to create and work with HTTP responses.</p><p>It offers convenience functions to create common responses and update them.</p></aside><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code><code> = <a href="../../../rock/Rock/Response/index.html#type-t">Rock.Response.t</a></code><code> = </code><code>{</code><table class="record"><tr id="type-t.version" class="anchored"><td class="def field"><a href="#type-t.version" class="anchor"></a><code>version : <a href="../../Opium/Version/index.html#type-t">Opium.Version.t</a>;</code></td></tr><tr id="type-t.status" class="anchored"><td class="def field"><a href="#type-t.status" class="anchor"></a><code>status : <a href="../../Opium/Status/index.html#type-t">Opium.Status.t</a>;</code></td></tr><tr id="type-t.reason" class="anchored"><td class="def field"><a href="#type-t.reason" class="anchor"></a><code>reason : <span>string option</span>;</code></td></tr><tr id="type-t.headers" class="anchored"><td class="def field"><a href="#type-t.headers" class="anchor"></a><code>headers : <a href="../../Opium/Headers/index.html#type-t">Opium.Headers.t</a>;</code></td></tr><tr id="type-t.body" class="anchored"><td class="def field"><a href="#type-t.body" class="anchor"></a><code>body : <a href="../../Opium/Body/index.html#type-t">Opium.Body.t</a>;</code></td></tr><tr id="type-t.env" class="anchored"><td class="def field"><a href="#type-t.env" class="anchor"></a><code>env : <a href="../../Opium/Context/index.html#type-t">Opium.Context.t</a>;</code></td></tr></table><code>}</code></dt></dl><section><header><h2 id="constructors"><a href="#constructors" class="anchor"></a>Constructors</h2></header><section><header><h4 id="make"><a href="#make" class="anchor"></a><code>make</code></h4></header><dl><dt class="spec value" id="val-make"><a href="#val-make" class="anchor"></a><code><span class="keyword">val</span> make : <span>?&#8288;version:<a href="../../Opium/Version/index.html#type-t">Opium.Version.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;status:<a href="../../Opium/Status/index.html#type-t">Opium.Status.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;reason:string</span> <span>&#45;&gt;</span> <span>?&#8288;headers:<a href="../../Opium/Headers/index.html#type-t">Opium.Headers.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;body:<a href="../../Opium/Body/index.html#type-t">Opium.Body.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;env:<a href="../../Opium/Context/index.html#type-t">Opium.Context.t</a></span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>make ?version ?status ?reason ?headers ?body ?env ()</code> creates a new response from the given values.</p><p>By default, the HTTP version will be set to 1.1, the HTTP status to 200 and the response will not contain any header or body.</p></dd></dl></section><section><header><h4 id="of_plain_text"><a href="#of_plain_text" class="anchor"></a><code>of_plain_text</code></h4></header><dl><dt class="spec value" id="val-of_plain_text"><a href="#val-of_plain_text" class="anchor"></a><code><span class="keyword">val</span> of_plain_text : <span>?&#8288;version:<a href="../../Opium/Version/index.html#type-t">Opium.Version.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;status:<a href="../../Opium/Status/index.html#type-t">Opium.Status.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;reason:string</span> <span>&#45;&gt;</span> <span>?&#8288;headers:<a href="../../Opium/Headers/index.html#type-t">Opium.Headers.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;env:<a href="../../Opium/Context/index.html#type-t">Opium.Context.t</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>of_plain_text ?status ?version ?reason ?headers ?env body</code> creates a new response from the given values and a string body.</p><p>The content type of the response will be set to <code>text/plain</code> and the body will contain the string <code>body</code>.</p><h4 id="example"><a href="#example" class="anchor"></a>Example</h4><p>The response initialized with:</p><pre><code class="ml">Response.of_plain_text &quot;Hello World&quot; </code></pre><p>Will be represented as:</p> <pre>
HTTP/1.1 200 
Content-Type: text/plain

Hello World </pre></dd></dl></section><section><header><h4 id="of_json"><a href="#of_json" class="anchor"></a><code>of_json</code></h4></header><dl><dt class="spec value" id="val-of_json"><a href="#val-of_json" class="anchor"></a><code><span class="keyword">val</span> of_json : <span>?&#8288;version:<a href="../../Opium/Version/index.html#type-t">Opium.Version.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;status:<a href="../../Opium/Status/index.html#type-t">Opium.Status.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;reason:string</span> <span>&#45;&gt;</span> <span>?&#8288;headers:<a href="../../Opium/Headers/index.html#type-t">Opium.Headers.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;env:<a href="../../Opium/Context/index.html#type-t">Opium.Context.t</a></span> <span>&#45;&gt;</span> Yojson.Safe.t <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>of_json ?status ?version ?reason ?headers ?env payload</code> creates a new response from the given values and a JSON body.</p><p>The content type of the response will be set to <code>application/json</code> and the body will contain the json payload <code>body</code>.</p><h4 id="example"><a href="#example" class="anchor"></a>Example</h4><p>The response initialized with:</p><pre><code class="ml">Response.of_json (`Assoc [ &quot;Hello&quot;, `String &quot;World&quot; ]) </code></pre><p>Will be represented as:</p> <pre>
HTTP/1.1 200 
Content-Type: application/json

{"Hello":"World"} </pre> </dd></dl></section><section><header><h4 id="of_html"><a href="#of_html" class="anchor"></a><code>of_html</code></h4></header><dl><dt class="spec value" id="val-of_html"><a href="#val-of_html" class="anchor"></a><code><span class="keyword">val</span> of_html : <span>?&#8288;version:<a href="../../Opium/Version/index.html#type-t">Opium.Version.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;status:<a href="../../Opium/Status/index.html#type-t">Opium.Status.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;reason:string</span> <span>&#45;&gt;</span> <span>?&#8288;headers:<a href="../../Opium/Headers/index.html#type-t">Opium.Headers.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;env:<a href="../../Opium/Context/index.html#type-t">Opium.Context.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;indent:bool</span> <span>&#45;&gt;</span> <span><span>[ `Html ]</span> Tyxml_html.elt</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>of_html ?status ?version ?reason ?headers ?env ?indent payload</code> creates a new response from the given values and a HTML body.</p><p>The content type of the response will be set to <code>text/html; charset=utf-8</code> and the body will contain the HTML payload <code>payload</code>.</p><p>The header <code>Connection</code> will be set to <code>Keep-Alive</code> to opimize for bandwitdh, since it is assumed that users who response HTML content will be likely to make further responses.</p><h4 id="example"><a href="#example" class="anchor"></a>Example</h4><p>The response initialized with:</p><pre><code class="ml">let my_page =
  let open Tyxml.Html in
  html (head (title (txt &quot;Title&quot;)) []) (body [ h1 [ txt &quot;Hello World!&quot; ] ])
;;

let res = Response.of_html ~indent:true my_page</code></pre><p><code>res</code> will be represented as:</p> <pre>
HTTP/1.1 200 
Connection: Keep-Alive
Content-Type: text/html; charset=utf-8

&lt;!DOCTYPE html&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;Title&lt;/title&gt;&lt;/head&gt;
 &lt;body&gt;&lt;h1&gt;Hello World!&lt;/h1&gt;&lt;/body&gt;
&lt;/html&gt; </pre> </dd></dl></section><section><header><h4 id="of_xml"><a href="#of_xml" class="anchor"></a><code>of_xml</code></h4></header><dl><dt class="spec value" id="val-of_xml"><a href="#val-of_xml" class="anchor"></a><code><span class="keyword">val</span> of_xml : <span>?&#8288;version:<a href="../../Opium/Version/index.html#type-t">Opium.Version.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;status:<a href="../../Opium/Status/index.html#type-t">Opium.Status.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;reason:string</span> <span>&#45;&gt;</span> <span>?&#8288;headers:<a href="../../Opium/Headers/index.html#type-t">Opium.Headers.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;env:<a href="../../Opium/Context/index.html#type-t">Opium.Context.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;indent:bool</span> <span>&#45;&gt;</span> Tyxml_xml.elt <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>of_xml ?status ?version ?reason ?headers ?env ?indent payload</code> creates a new response from the given values and a XML body.</p><p>The content type of the response will be set to <code>text/xml; charset=utf-8</code> and the body will contain the XML payload <code>payload</code>.</p><h4 id="example"><a href="#example" class="anchor"></a>Example</h4><p>The response initialized with:</p><pre><code class="ml">let xml =
  let open Tyxml.Xml in
  node
    &quot;note&quot;
    [ node &quot;to&quot; [ pcdata &quot;Tove&quot; ]
    ; node &quot;from&quot; [ pcdata &quot;Jani&quot; ]
    ; node &quot;heading&quot; [ pcdata &quot;Reminder&quot; ]
    ; node &quot;body&quot; [ pcdata &quot;Don't forget me this weekend!&quot; ]
    ]
;;

let res = Response.of_xml ~indent:true xml</code></pre><p><code>res</code> will be represented as:</p> <pre>
HTTP/1.1 200 
Content-Type: application/xml charset=utf-8

&lt;note&gt;&lt;to&gt;Tove&lt;/to&gt;&lt;from&gt;Jani&lt;/from&gt;&lt;heading&gt;Reminder&lt;/heading&gt;
 &lt;body&gt;Don't forget me this weekend!&lt;/body&gt;
&lt;/note&gt; </pre> </dd></dl></section><section><header><h4 id="of_svg"><a href="#of_svg" class="anchor"></a><code>of_svg</code></h4></header><dl><dt class="spec value" id="val-of_svg"><a href="#val-of_svg" class="anchor"></a><code><span class="keyword">val</span> of_svg : <span>?&#8288;version:<a href="../../Opium/Version/index.html#type-t">Opium.Version.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;status:<a href="../../Opium/Status/index.html#type-t">Opium.Status.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;reason:string</span> <span>&#45;&gt;</span> <span>?&#8288;headers:<a href="../../Opium/Headers/index.html#type-t">Opium.Headers.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;env:<a href="../../Opium/Context/index.html#type-t">Opium.Context.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;indent:bool</span> <span>&#45;&gt;</span> <span><span>[ `Svg ]</span> Tyxml_svg.elt</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>of_svg ?status ?version ?reason ?headers ?env ?indent payload</code> creates a new response from the given values and a SVG body.</p><p>The content type of the response will be set to <code>image/svg+xml</code> and the body will contain the SVG payload <code>payload</code>.</p><p>The header <code>Connection</code> will be set to <code>Keep-Alive</code> to opimize for bandwitdh, since it is assumed that users who response SVG content will be likely to make further responses.</p><h4 id="example"><a href="#example" class="anchor"></a>Example</h4><p>The response initialized with:</p><pre><code class="ml">let my_svg =
  let open Tyxml.Svg in
  svg
    [ circle
        ~a:
          [ a_cx (50., None)
          ; a_cy (50., None)
          ; a_r (40., None)
          ; a_fill (`Color (&quot;black&quot;, None))
          ]
        []
    ]
;;

let res = Response.of_svg ~indent:true my_svg</code></pre><p><code>res</code> will be represented as:</p> <pre>
HTTP/1.1 200 
Connection: Keep-Alive
Content-Type: image/svg+xml

&lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot; &quot;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&quot;&gt;
&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot;
 xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;
 &lt;circle cx=&quot;50&quot; cy=&quot;50&quot; r=&quot;40&quot; fill=&quot;black&quot;&gt;&lt;/circle&gt;
&lt;/svg&gt; </pre> </dd></dl></section><section><header><h4 id="redirect_to"><a href="#redirect_to" class="anchor"></a><code>redirect_to</code></h4></header><dl><dt class="spec value" id="val-redirect_to"><a href="#val-redirect_to" class="anchor"></a><code><span class="keyword">val</span> redirect_to : <span>?&#8288;status:<a href="../../Opium/Status/index.html#type-redirection">Opium.Status.redirection</a></span> <span>&#45;&gt;</span> <span>?&#8288;version:<a href="../../Opium/Version/index.html#type-t">Opium.Version.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;reason:string</span> <span>&#45;&gt;</span> <span>?&#8288;headers:<a href="../../Opium/Headers/index.html#type-t">Opium.Headers.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;env:<a href="../../Opium/Context/index.html#type-t">Opium.Context.t</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>redirect_to ?status ?version ?reason ?headers ?env target</code> creates a new Redirect response from the given values.</p><p>The response will contain the header <code>Location</code> with the value <code>target</code> and a Redirect HTTP status (a Redirect HTTP status starts with 3).</p><p>By default, the HTTP status is <code>302 Found</code>.</p><p>The response initialized with:</p><pre><code class="ml">Response.redirect_to &quot;/redirected&quot; </code></pre><p>Will be represented as:</p> <pre>
HTTP/1.1 302 
Location: /redirected

</pre></dd></dl></section></section><section><header><h2 id="decoders"><a href="#decoders" class="anchor"></a>Decoders</h2></header><section><header><h4 id="to_json"><a href="#to_json" class="anchor"></a><code>to_json</code></h4></header><dl><dt class="spec value" id="val-to_json"><a href="#val-to_json" class="anchor"></a><code><span class="keyword">val</span> to_json : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span>Yojson.Safe.t option</span> Lwt.t</span></code></dt><dd><p><code>to_json t</code> parses the body of the response <code>t</code> as a JSON structure.</p><p>If the body of the response cannot be parsed as a JSON structure, <code>None</code> is returned. Use <a href="index.html#to_json_exn"><span><code>to_json_exn</code></span></a> to raise an exception instead.</p><h4 id="example"><a href="#example" class="anchor"></a>Example</h4><pre><code class="ml">let response = Response.of_json (`Assoc [ &quot;Hello&quot;, `String &quot;World&quot; ])
let body = Response.to_json response</code></pre><p><code>body</code> will be:</p><pre><code class="ml">`Assoc [ &quot;Hello&quot;, `String &quot;World&quot; ] </code></pre></dd></dl></section><section><header><h4 id="to_json_exn"><a href="#to_json_exn" class="anchor"></a><code>to_json_exn</code></h4></header><dl><dt class="spec value" id="val-to_json_exn"><a href="#val-to_json_exn" class="anchor"></a><code><span class="keyword">val</span> to_json_exn : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>Yojson.Safe.t Lwt.t</span></code></dt><dd><p><code>to_json_exn t</code> parses the body of the response <code>t</code> as a JSON structure.</p><p>If the body of the response cannot be parsed as a JSON structure, an <code>Invalid_argument</code> exception is raised. Use <a href="index.html#to_json"><span><code>to_json</code></span></a> to return an option instead.</p></dd></dl></section><section><header><h4 id="to_plain_text"><a href="#to_plain_text" class="anchor"></a><code>to_plain_text</code></h4></header><dl><dt class="spec value" id="val-to_plain_text"><a href="#val-to_plain_text" class="anchor"></a><code><span class="keyword">val</span> to_plain_text : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>string Lwt.t</span></code></dt><dd><p><code>to_plain_text t</code> parses the body of the response <code>t</code> as a string.</p><h4 id="example"><a href="#example" class="anchor"></a>Example</h4><pre><code class="ml">let response = Response.of_plain_text &quot;Hello world!&quot;
let body = Response.to_json response</code></pre><p><code>body</code> will be:</p><pre><code class="ml">&quot;Hello world!&quot; </code></pre></dd></dl></section></section><section><header><h2 id="getters-and-setters"><a href="#getters-and-setters" class="anchor"></a>Getters and Setters</h2></header><section><header><h4 id="status"><a href="#status" class="anchor"></a><code>status</code></h4></header><dl><dt class="spec value" id="val-status"><a href="#val-status" class="anchor"></a><code><span class="keyword">val</span> status : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../Opium/Status/index.html#type-t">Opium.Status.t</a></code></dt><dd><p><code>status response</code> returns the HTTP status of the response <code>response</code>.</p></dd></dl></section><section><header><h4 id="set_status"><a href="#set_status" class="anchor"></a><code>set_status</code></h4></header><dl><dt class="spec value" id="val-set_status"><a href="#val-set_status" class="anchor"></a><code><span class="keyword">val</span> set_status : <a href="../../Opium/Status/index.html#type-t">Opium.Status.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>set_status status response</code> returns a copy of <code>response</code> with the HTTP status set to <code>content_type</code>.</p></dd></dl></section><section><header><h3 id="general-headers"><a href="#general-headers" class="anchor"></a>General Headers</h3></header><dl><dt class="spec value" id="val-header"><a href="#val-header" class="anchor"></a><code><span class="keyword">val</span> header : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p><code>header key t</code> returns the value of the header with key <code>key</code> in the response <code>t</code>.</p><p>If multiple headers have the key <code>key</code>, only the value of the first header will be returned.</p><p>If you want to return all the values if multiple headers are found, you can use <a href="index.html#type-t.headers"><code>headers</code></a>.</p></dd></dl><section><header><h4 id="headers"><a href="#headers" class="anchor"></a><code>headers</code></h4></header><dl><dt class="spec value" id="val-headers"><a href="#val-headers" class="anchor"></a><code><span class="keyword">val</span> headers : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>string list</span></code></dt><dd><p><code>headers</code> returns the values of all headers with the key <code>key</code> in the response <code>t</code>.</p><p>If you want to return the value of only the first header with the key <code>key</code>, you can use <a href="index.html#val-header"><code>header</code></a>.</p></dd></dl></section><section><header><h4 id="add_header"><a href="#add_header" class="anchor"></a><code>add_header</code></h4></header><dl><dt class="spec value" id="val-add_header"><a href="#val-add_header" class="anchor"></a><code><span class="keyword">val</span> add_header : <span>(string * string)</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>add_header (key, value) t</code> adds a header with the key <code>key</code> and the value <code>value</code> to the response <code>t</code>.</p><p>If a header with the same key is already persent, a new header is appended to the list of headers regardless. If you want to add the header only if an header with the same key could not be found, you can use <a href="index.html#add_header_unless_exists"><span><code>add_header_unless_exists</code></span></a>.</p><p>See also <a href="index.html#add_headers"><span><code>add_headers</code></span></a> to add multiple headers.</p></dd></dl></section><section><header><h4 id="add_header_or_replace"><a href="#add_header_or_replace" class="anchor"></a><code>add_header_or_replace</code></h4></header><dl><dt class="spec value" id="val-add_header_or_replace"><a href="#val-add_header_or_replace" class="anchor"></a><code><span class="keyword">val</span> add_header_or_replace : <span>(string * string)</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>add_header_or_replace (key, value) t</code> adds a header with the key <code>key</code> and the value <code>value</code> to the response <code>t</code>.</p><p>If a header with the same key already exist, its value is replaced by <code>value</code>. If you want to add the header only if it doesn't already exist, you can use <a href="index.html#add_header_unless_exists"><span><code>add_header_unless_exists</code></span></a>.</p><p>See also <a href="index.html#add_headers_or_replace"><span><code>add_headers_or_replace</code></span></a> to add multiple headers.</p></dd></dl></section><section><header><h4 id="add_header_unless_exists"><a href="#add_header_unless_exists" class="anchor"></a><code>add_header_unless_exists</code></h4></header><dl><dt class="spec value" id="val-add_header_unless_exists"><a href="#val-add_header_unless_exists" class="anchor"></a><code><span class="keyword">val</span> add_header_unless_exists : <span>(string * string)</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>add_header_unless_exists (key, value) t</code> adds a header with the key <code>key</code> and the value <code>value</code> to the response <code>t</code> if an header with the same key does not already exist.</p><p>If a header with the same key already exist, the response remains unmodified. If you want to add the header regardless of whether the header is already present, you can use <a href="index.html#add_header"><span><code>add_header</code></span></a>.</p><p>See also <a href="index.html#add_headers_unless_exists"><span><code>add_headers_unless_exists</code></span></a> to add multiple headers.</p></dd></dl></section><section><header><h4 id="add_headers"><a href="#add_headers" class="anchor"></a><code>add_headers</code></h4></header><dl><dt class="spec value" id="val-add_headers"><a href="#val-add_headers" class="anchor"></a><code><span class="keyword">val</span> add_headers : <span><span>(string * string)</span> list</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>add_headers headers response</code> adds the headers <code>headers</code> to the response <code>t</code>.</p><p>The headers are added regardless of whether a header with the same key is already present. If you want to add the header only if an header with the same key could not be found, you can use <a href="index.html#add_headers_unless_exists"><span><code>add_headers_unless_exists</code></span></a>.</p><p>See also <a href="index.html#add_header"><span><code>add_header</code></span></a> to add a single header.</p></dd></dl></section><section><header><h4 id="add_headers_or_replace"><a href="#add_headers_or_replace" class="anchor"></a><code>add_headers_or_replace</code></h4></header><dl><dt class="spec value" id="val-add_headers_or_replace"><a href="#val-add_headers_or_replace" class="anchor"></a><code><span class="keyword">val</span> add_headers_or_replace : <span><span>(string * string)</span> list</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>add_headers_or_replace (key, value) t</code> adds a headers <code>headers</code> to the response <code>t</code>.</p><p>If a header with the same key already exist, its value is replaced by <code>value</code>. If you want to add the header only if it doesn't already exist, you can use <a href="index.html#add_headers_unless_exists"><span><code>add_headers_unless_exists</code></span></a>.</p><p>See also <a href="index.html#add_header_or_replace"><span><code>add_header_or_replace</code></span></a> to add a single header.</p></dd></dl></section><section><header><h4 id="add_headers_unless_exists"><a href="#add_headers_unless_exists" class="anchor"></a><code>add_headers_unless_exists</code></h4></header><dl><dt class="spec value" id="val-add_headers_unless_exists"><a href="#val-add_headers_unless_exists" class="anchor"></a><code><span class="keyword">val</span> add_headers_unless_exists : <span><span>(string * string)</span> list</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>add_headers_unless_exists headers response</code> adds the headers <code>headers</code> to the response <code>t</code> if an header with the same key does not already exist.</p><p>If a header with the same key already exist, the header is will not be added to the response. If you want to add the header regardless of whether the header is already present, you can use <a href="index.html#add_headers"><span><code>add_headers</code></span></a>.</p><p>See also <a href="index.html#add_header_unless_exists"><span><code>add_header_unless_exists</code></span></a> to add a single header.</p></dd></dl></section><section><header><h4 id="remove_header"><a href="#remove_header" class="anchor"></a><code>remove_header</code></h4></header><dl><dt class="spec value" id="val-remove_header"><a href="#val-remove_header" class="anchor"></a><code><span class="keyword">val</span> remove_header : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>remove_header (key, value) t</code> removes all the headers with the key <code>key</code> from the response <code>t</code>.</p><p>If no header with the key <code>key</code> exist, the response remains unmodified.</p></dd></dl></section></section><section><header><h3 id="specific-headers"><a href="#specific-headers" class="anchor"></a>Specific Headers</h3></header><section><header><h4 id="content_type"><a href="#content_type" class="anchor"></a><code>content_type</code></h4></header><dl><dt class="spec value" id="val-content_type"><a href="#val-content_type" class="anchor"></a><code><span class="keyword">val</span> content_type : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p><code>content_type response</code> returns the value of the header <code>Content-Type</code> of the response <code>response</code>.</p></dd></dl></section><section><header><h4 id="set_content_type"><a href="#set_content_type" class="anchor"></a><code>set_content_type</code></h4></header><dl><dt class="spec value" id="val-set_content_type"><a href="#val-set_content_type" class="anchor"></a><code><span class="keyword">val</span> set_content_type : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>set_content_type content_type response</code> returns a copy of <code>response</code> with the value of the header <code>Content-Type</code> set to <code>content_type</code>.</p></dd></dl></section><section><header><h4 id="etag"><a href="#etag" class="anchor"></a><code>etag</code></h4></header><dl><dt class="spec value" id="val-etag"><a href="#val-etag" class="anchor"></a><code><span class="keyword">val</span> etag : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p><code>etag response</code> returns the value of the header <code>ETag</code> of the response <code>response</code>.</p></dd></dl></section><section><header><h4 id="set_etag"><a href="#set_etag" class="anchor"></a><code>set_etag</code></h4></header><dl><dt class="spec value" id="val-set_etag"><a href="#val-set_etag" class="anchor"></a><code><span class="keyword">val</span> set_etag : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>set_etag etag response</code> returns a copy of <code>response</code> with the value of the header <code>ETag</code> set to <code>etag</code>.</p></dd></dl></section><section><header><h4 id="location"><a href="#location" class="anchor"></a><code>location</code></h4></header><dl><dt class="spec value" id="val-location"><a href="#val-location" class="anchor"></a><code><span class="keyword">val</span> location : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p><code>location response</code> returns the value of the header <code>Location</code> of the response <code>response</code>.</p></dd></dl></section><section><header><h4 id="set_location"><a href="#set_location" class="anchor"></a><code>set_location</code></h4></header><dl><dt class="spec value" id="val-set_location"><a href="#val-set_location" class="anchor"></a><code><span class="keyword">val</span> set_location : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>set_location location response</code> returns a copy of <code>response</code> with the value of the header <code>Location</code> set to <code>location</code>.</p></dd></dl></section><section><header><h4 id="cache_control"><a href="#cache_control" class="anchor"></a><code>cache_control</code></h4></header><dl><dt class="spec value" id="val-cache_control"><a href="#val-cache_control" class="anchor"></a><code><span class="keyword">val</span> cache_control : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p><code>cache_control response</code> returns the value of the header <code>Cache-Control</code> of the response <code>response</code>.</p></dd></dl></section><section><header><h4 id="set_cache_control"><a href="#set_cache_control" class="anchor"></a><code>set_cache_control</code></h4></header><dl><dt class="spec value" id="val-set_cache_control"><a href="#val-set_cache_control" class="anchor"></a><code><span class="keyword">val</span> set_cache_control : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>set_cache_control cache_control response</code> returns a copy of <code>response</code> with the value of the header <code>Cache-Control</code> set to <code>cache_control</code>.</p></dd></dl></section><section><header><h4 id="cookie"><a href="#cookie" class="anchor"></a><code>cookie</code></h4></header><dl><dt class="spec value" id="val-cookie"><a href="#val-cookie" class="anchor"></a><code><span class="keyword">val</span> cookie : <span>?&#8288;signed_with:<a href="../../Opium/Cookie/Signer/index.html#type-t">Opium.Cookie.Signer.t</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../../Opium/Cookie/index.html#type-t">Opium.Cookie.t</a> option</span></code></dt><dd><p><code>cookie ?signed_with key t</code> returns the value of the cookie with key <code>key</code> in the <code>Set-Cookie</code> header of the response <code>t</code>.</p><p>If <code>signed_with</code> is provided, the cookies will be unsigned with the given Signer and only a cookie with a valid signature will be returned.</p><p>If the response does not contain a valid <code>Set-Cookie</code> or if no cookie with the key <code>key</code> exist, <code>None</code> will be returned.</p></dd></dl></section><section><header><h4 id="cookies"><a href="#cookies" class="anchor"></a><code>cookies</code></h4></header><dl><dt class="spec value" id="val-cookies"><a href="#val-cookies" class="anchor"></a><code><span class="keyword">val</span> cookies : <span>?&#8288;signed_with:<a href="../../Opium/Cookie/Signer/index.html#type-t">Opium.Cookie.Signer.t</a></span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../../Opium/Cookie/index.html#type-t">Opium.Cookie.t</a> list</span></code></dt><dd><p><code>cookies ?signed_with t</code> returns all the value of the cookies in the <code>Set-Cookie</code> header of the response <code>t</code>.</p><p>If <code>signed_with</code> is provided, the cookies will be unsigned with the given Signer and only the cookies with a valid signature will be returned.</p><p>If the response does not contain a valid <code>Set-Cookie</code>, <code>None</code> will be returned.</p></dd></dl></section><section><header><h4 id="add_cookie"><a href="#add_cookie" class="anchor"></a><code>add_cookie</code></h4></header><dl><dt class="spec value" id="val-add_cookie"><a href="#val-add_cookie" class="anchor"></a><code><span class="keyword">val</span> add_cookie : <span>?&#8288;sign_with:<a href="../../Opium/Cookie/Signer/index.html#type-t">Opium.Cookie.Signer.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;expires:<a href="../../Opium/Cookie/index.html#type-expires">Opium.Cookie.expires</a></span> <span>&#45;&gt;</span> <span>?&#8288;scope:Uri.t</span> <span>&#45;&gt;</span> <span>?&#8288;same_site:<a href="../../Opium/Cookie/index.html#type-same_site">Opium.Cookie.same_site</a></span> <span>&#45;&gt;</span> <span>?&#8288;secure:bool</span> <span>&#45;&gt;</span> <span>?&#8288;http_only:bool</span> <span>&#45;&gt;</span> <a href="../../Opium/Cookie/index.html#type-value">Opium.Cookie.value</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>add_cookie ?sign_with ?expires ?scope ?same_site ?secure ?http_only value t</code> adds a cookie with value <code>value</code> to the response <code>t</code>.</p><p>If a cookie with the same key already exists, its value will be replaced with the new value of <code>value</code>.</p><p>If <code>sign_with</code> is provided, the cookie will be signed with the given Signer.</p></dd></dl></section><section><header><h4 id="add_cookie_or_replace"><a href="#add_cookie_or_replace" class="anchor"></a><code>add_cookie_or_replace</code></h4></header><dl><dt class="spec value" id="val-add_cookie_or_replace"><a href="#val-add_cookie_or_replace" class="anchor"></a><code><span class="keyword">val</span> add_cookie_or_replace : <span>?&#8288;sign_with:<a href="../../Opium/Cookie/Signer/index.html#type-t">Opium.Cookie.Signer.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;expires:<a href="../../Opium/Cookie/index.html#type-expires">Opium.Cookie.expires</a></span> <span>&#45;&gt;</span> <span>?&#8288;scope:Uri.t</span> <span>&#45;&gt;</span> <span>?&#8288;same_site:<a href="../../Opium/Cookie/index.html#type-same_site">Opium.Cookie.same_site</a></span> <span>&#45;&gt;</span> <span>?&#8288;secure:bool</span> <span>&#45;&gt;</span> <span>?&#8288;http_only:bool</span> <span>&#45;&gt;</span> <a href="../../Opium/Cookie/index.html#type-value">Opium.Cookie.value</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>add_cookie_or_replace ?sign_with ?expires ?scope ?same_site ?secure ?http_only value
    t</code> adds a cookie with value <code>value</code> to the response <code>t</code>. If a cookie with the same key already exists, its value will be replaced with the new value of <code>value</code>. If <code>sign_with</code> is provided, the cookie will be signed with the given Signer.</p></dd></dl></section><section><header><h4 id="add_cookie_unless_exists"><a href="#add_cookie_unless_exists" class="anchor"></a><code>add_cookie_unless_exists</code></h4></header><dl><dt class="spec value" id="val-add_cookie_unless_exists"><a href="#val-add_cookie_unless_exists" class="anchor"></a><code><span class="keyword">val</span> add_cookie_unless_exists : <span>?&#8288;sign_with:<a href="../../Opium/Cookie/Signer/index.html#type-t">Opium.Cookie.Signer.t</a></span> <span>&#45;&gt;</span> <span>?&#8288;expires:<a href="../../Opium/Cookie/index.html#type-expires">Opium.Cookie.expires</a></span> <span>&#45;&gt;</span> <span>?&#8288;scope:Uri.t</span> <span>&#45;&gt;</span> <span>?&#8288;same_site:<a href="../../Opium/Cookie/index.html#type-same_site">Opium.Cookie.same_site</a></span> <span>&#45;&gt;</span> <span>?&#8288;secure:bool</span> <span>&#45;&gt;</span> <span>?&#8288;http_only:bool</span> <span>&#45;&gt;</span> <a href="../../Opium/Cookie/index.html#type-value">Opium.Cookie.value</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>add_cookie_unless_exists ?sign_with ?expires ?scope ?same_site ?secure ?http_only
    value t</code> adds a cookie with value <code>value</code> to the response <code>t</code>.</p><p>If a cookie with the same key already exists, it will remain untouched.</p><p>If <code>sign_with</code> is provided, the cookie will be signed with the given Signer.</p></dd></dl></section><section><header><h4 id="remove_cookie"><a href="#remove_cookie" class="anchor"></a><code>remove_cookie</code></h4></header><dl><dt class="spec value" id="val-remove_cookie"><a href="#val-remove_cookie" class="anchor"></a><code><span class="keyword">val</span> remove_cookie : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>remove_cookie key t</code> removes the cookie of key <code>key</code> from the <code>Set-Cookie</code> header of the response <code>t</code>.</p></dd></dl></section></section></section><section><header><h2 id="utilities"><a href="#utilities" class="anchor"></a>Utilities</h2></header><section><header><h4 id="sexp_of_t"><a href="#sexp_of_t" class="anchor"></a><code>sexp_of_t</code></h4></header><dl><dt class="spec value" id="val-sexp_of_t"><a href="#val-sexp_of_t" class="anchor"></a><code><span class="keyword">val</span> sexp_of_t : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Sexplib0.Sexp.t</code></dt><dd><p><code>sexp_of_t t</code> converts the response <code>t</code> to an s-expression</p></dd></dl></section><section><header><h4 id="pp"><a href="#pp" class="anchor"></a><code>pp</code></h4></header><dl><dt class="spec value" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span class="keyword">val</span> pp : Stdlib.Format.formatter <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>pp</code> formats the response <code>t</code> as an s-expression</p></dd></dl></section><section><header><h4 id="pp_hum"><a href="#pp_hum" class="anchor"></a><code>pp_hum</code></h4></header><dl><dt class="spec value" id="val-pp_hum"><a href="#val-pp_hum" class="anchor"></a><code><span class="keyword">val</span> pp_hum : Stdlib.Format.formatter <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>pp_hum</code> formats the response <code>t</code> as a standard HTTP response</p></dd></dl></section></section></div></body></html>